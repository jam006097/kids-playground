# APIエンドポイント設計書

本システムの主要なAPIエンドポイントと、それらを通じたインタラクションの概要をまとめます。本アプリケーションは主にDjangoのテンプレートレンダリングを使用し、一部の機能（お気に入り、レビュー投稿、AI要約）にはAJAX（非同期通信）を利用しています。

---

## お気に入り関連 (AJAX)

| エンドポイント           | メソッド | 概要             | リクエストボディ     | 成功レスポンス (200 OK) | エラーレスポンス (400 Bad Request) | 認証 |
|------------------------|----------|------------------|----------------------|-------------------------|---------------------------------------|------|
| `/add_favorite/`       | POST     | お気に入り登録    | `playground_id`      | `{"status": "ok"}`     | `{"status": "error", "message": "..."}` | 必要 |
| `/remove_favorite/`    | POST     | お気に入り削除    | `playground_id`      | `{"status": "ok"}`     | `{"status": "error", "message": "..."}` | 必要 |

---

## レビュー関連 (AJAX)

| エンドポイント           | メソッド | 概要             | リクエストボディ     | 成功レスポンス (200 OK) | エラーレスポンス (400 Bad Request) | 認証 |
|------------------------|----------|------------------|----------------------|-------------------------|---------------------------------------|------|
| `/playground/<int:playground_id>/add_review/` | POST | レビュー投稿      | `content`, `rating`  | `{"status": "success", "message": "口コミが投稿されました！"}` | `{"status": "error", "message": "..."}` | 必要 |

---

## ページ表示関連 (通常リクエスト)

| エンドポイント           | メソッド | 概要             | URLパラメータ例      | レスポンス           | 認証 |
|------------------------|----------|------------------|----------------------|----------------------|------|
| `/`                    | GET      | 施設一覧表示      | `?city=東京都`       | HTMLページ           | 不要 |
| `/facilities/<int:pk>/`| GET      | 施設詳細表示      | なし                 | HTMLページ           | 不要 |
| `/ranking/`            | GET      | 施設ランキング表示| `?sort=review_count` | HTMLページ           | 不要 |
| `/favorites/`          | GET      | お気に入り一覧表示| `?city=東京都`       | HTMLページ           | 必要 |
| `/playground/<int:playground_id>/reviews/` | GET | レビュー一覧表示  | なし                 | HTMLページ           | 不要 |
| `/about/`              | GET      | このサイトについて| なし                 | HTMLページ           | 不要 |
| `/chat/`               | GET      | AIチャット        | なし                 | HTMLページ           | 不要 |

---

## ユーザー関連（django-allauth および accounts アプリによる提供）

| エンドポイント           | メソッド | 概要             | パラメータ例         | レスポンス           | 認証 |
|------------------------|----------|------------------|----------------------|----------------------|------|
| `/accounts/signup/`    | GET/POST | 会員登録          | `email`, `password`  | HTMLページ           | 不要 |
| `/accounts/login/`     | GET/POST | ログイン          | `email`, `password`  | HTMLページ           | 不要 |
| `/accounts/logout/`    | GET/POST | ログアウト        | なし                 | HTMLページ           | 必要 |
| `/accounts/mypage/`    | GET      | マイページ表示    | なし                 | HTMLページ           | 必要 |
| `/accounts/name/`      | GET/POST | アカウント名変更  | `account_name`       | HTMLページ           | 必要 |
