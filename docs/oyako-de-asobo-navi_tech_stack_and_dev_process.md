## DjangoとTypeScriptを用いたポートフォリオの技術スタックと開発プロセス

### はじめに
本記事は、私のポートフォリオサイト「親子で遊ぼうナビ」の技術選定、アーキテクチャ、そして開発プロセスにおけるこだわりを解説するものです。単に動くものを作るだけでなく、保守性、拡張性、テスト容易性を重視し、実務で通用する品質を目指しました。
[ポートフォリオサイト](https://kidsplayground.onrender.com/)

### 1. プロジェクト概要と主要技術スタック
「親子で遊ぼうナビ」は、**子供と出かける施設情報を提供するWebアプリケーション**です。ユーザーは様々な施設の情報を検索・閲覧し、お出かけの計画に役立てることができます。

このプロジェクトを支える主要な技術スタックは以下の通りです。

*   **バックエンド:** Python 3.12.3, Django 5.1.5, PostgreSQL
*   **フロントエンド:** **TypeScript**, ES Modules
*   **インフラ/開発環境:** Docker, Docker Compose
*   **コード品質/テスト:** pytest, Jest, **TypeScript**, mypy (django-stubs), flake8, black, ESLint, Prettier, **bandit**
*   **CI/CD:** GitHub Actions

### 2. 堅牢なアーキテクチャ設計
プロジェクトの基盤となるアーキテクチャは、開発効率と将来的な拡張性を考慮して設計しました。

#### バックエンド (Django) とフロントエンドの連携
アプリケーションは、Djangoのテンプレートエンジンを主軸とし、サーバーサイドレンダリングによって基本的なUIを構築しています。
*   **Djangoの標準ビュー:** 堅牢なバックエンド機能を提供し、データ管理とビジネスロジック、そしてHTMLのレンダリングを担当。
*   **TypeScriptとES Modules:** クライアントサイドでのインタラクティブな機能（地図操作、お気に入り、口コミ投稿など）は、TypeScriptで記述されたモジュールによって実現しています。TypeScriptコンパイラ(`tsc`)によるビルドプロセスを経て、ブラウザが解釈可能なJavaScript（ES Modules形式）が生成されます。

この構成により、Djangoの持つ強力な機能を最大限に活用しつつ、フロントエンドのコードベースに型安全性と保守性をもたらし、モダンな開発手法を実践しています。

#### データベース
信頼性と豊富な機能を考慮し、リレーショナルデータベースにはPostgreSQLを採用しました。

### 3. 品質を担保する開発プロセスとツール
本プロジェクトでは、コードの品質と開発効率を両立させるため、厳格な開発プロセスと多様なツールを導入しています。

#### TDD (テスト駆動開発) の実践
開発の核として、TDDスタイルを全面的に採用しました。
「Red → Green → Refactor」のサイクルを徹底し、小さなステップで開発を進めることで、バグの早期発見と設計の改善を促しました。

テストコードは、単に機能が動くことを確認するだけでなく、アプリケーションの「振る舞い」を明確に記述する「動く仕様書」として設計しました。特に、テストケース名には**日本語を積極的に採用**し、非エンジニアを含む関係者でも仕様を理解しやすいように工夫しています。また、「振る舞いをテストし、実装の詳細はテストしない」という原則を遵守することで、リファクタリングに強く、壊れにくいテストコードを実現しています。

*   **テストフレームワーク:** バックエンドには`pytest`を、フロントエンドには`Jest`を採用し、それぞれの言語・フレームワークに最適化されたテスト環境を構築しています。


#### 静的解析と型チェックによる品質向上
コードの品質と保守性を高めるため、以下の静的解析ツールと型チェッカーを導入しています。

*   **Python (バックエンド):**
    *   `flake8`: コード規約違反や潜在的なバグを検出。
    *   `black`: コードフォーマットを自動で統一。
    *   `bandit`: コードに潜むセキュリティ脆弱性を静的に解析。
    *   **Mypyとdjango-stubsによる厳格な型チェック:**
        `mypy.ini`で`disallow_untyped_defs = True`を設定し、全ての関数定義に型ヒントの記述を強制しています。これにより、開発初期段階での型関連のバグを排除し、コードの安全性を飛躍的に高めました。

*   **TypeScript (フロントエンド):**
    *   **TypeScriptコンパイラ(`tsc`)**: 静的な型チェックを提供し、JavaScriptでは実行時まで気づけないような型に関するエラーを、開発段階で排除します。
    *   `ESLint`: コード品質とスタイルを自動でチェック。
    *   `Prettier`: コードフォーマットを自動で統一。


#### CI/CD (GitHub Actions) による自動化
開発プロセスを効率化し、常に高品質なコードを維持するため、GitHub Actionsを用いたCI/CDパイプラインを構築しています。
`main`ブランチへのPushをトリガーに、以下の処理を自動で実行します。

1.  **静的解析とテスト**: `flake8`, `bandit`, `pytest`, `npm test`などを実行し、コード品質と機能の正常性を検証します。
2.  **セキュリティ監査**: `pip-audit`と`npm audit`で、依存関係の脆弱性をチェックします。
3.  **Django設定チェック**: `manage.py check --deploy`を実行し、本番環境向け設定の安全性を検証します。
4.  **Dockerイメージのビルドとプッシュ**: フロントエンドのビルド(`npm run build`)と静的ファイルの収集(`collectstatic`)を含んだ、本番用のDockerイメージをビルドし、コンテナレジストリにプッシュします。
5.  **Renderへのデプロイ**: RenderのAPIを呼び出し、新しいイメージでのデプロイをトリガーします。

このパイプラインにより、コード品質のゲートウェイを設け、安全で安定したデプロイを自動で実現しています。

### 4. 各技術領域における工夫と学び
#### 保守性と可読性を意識した設計
単一責任の原則（SRP）を始めとするSOLID原則を意識し、クラスや関数の責務を明確に分離しました。

#### 適切なディレクトリ構造
Django標準のディレクトリ構造に準拠しつつ、大規模化に備えて各アプリケーション内の構造も整理しています。特に`templates`, `static`, `tests`を明確に分離し、コードの見通しを良くしています。

```
/home/jam/kidsPlayGround/
├───accounts/
├───myapp/
│   ├───static/
│   │   ├───js/
│   │   │   ├───dist/      # コンパイル後のJSが出力される
│   │   │   ├───tests/     # フロントエンドのテスト
│   │   │   ├───favorite.ts
│   │   │   ├───map.ts
│   │   │   └───...ts      # ソースファイルはTypeScriptで記述
│   ├───templates/
│   └───views/       # ビューの責務を分割
├───mysite/
│   └───settings/    # 設定ファイルを環境ごとに分割
├───users/
├───.github/
│   └───workflows/
│       └───main.yml # CI/CDパイプライン
├───Dockerfile       # フロントエンドのビルド工程を含む
├───package.json
├───tsconfig.json      # TypeScriptの設定ファイル
└───... # 他の設定ファイル
```
例えば、`myapp/views/`以下にさらにファイルを分割することで、ビューの責務を細分化し、可読性と保守性を高めています。

### 5. まとめと今後の展望
本プロジェクトを通じて、単一技術の習得に留まらず、モダンなWebアプリケーション開発における一連のプロセス（設計、実装、テスト、品質管理、CI/CD）を実践的に経験しました。特に、TDDやバックエンド・フロントエンド両方での厳格な型チェック、そしてDockerを中心としたCI/CDの導入は、コードの品質と開発効率を両立させる上で不可欠であることを実感しました。

この経験を活かし、貴社で即戦力として貢献できると確信しております。
